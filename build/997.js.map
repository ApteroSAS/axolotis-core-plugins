{"version":3,"file":"997.js","mappings":"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","sources":["webpack://axolotis-player/./src/lib/modules/debug/DebugBtn.ts","webpack://axolotis-player/./node_modules/three/examples/jsm/libs/stats.module.js","webpack://axolotis-player/./src/lib/modules/debug/PerformanceStats.ts","webpack://axolotis-player/./src/lib/modules/debug/rStats/rStats.extras.ts","webpack://axolotis-player/./src/lib/modules/debug/rStats/rStats.ts","webpack://axolotis-player/./src/lib/modules/three/ThreeAssetsLoader.ts","webpack://axolotis-player/./src/lib/modules/three/ThreeLib.ts"],"sourcesContent":["import { WebpackLazyModule } from \"@aptero/axolotis-player/build/types/modules/core/loader/WebpackLoader\";\nimport {\n  LazyServices,\n  Service,\n} from \"@aptero/axolotis-player/build/types/modules/core/service/LazyServices\";\nimport { FrameLoop } from \"@aptero/axolotis-player/build/types/modules/FrameLoop\";\nimport Component from \"@aptero/axolotis-player/build/types/modules/core/ecs/Component\";\nimport { PerformanceStats } from \"@root/lib/modules/debug/PerformanceStats\";\n\nexport class Factory implements WebpackLazyModule, Service<DebugBtn> {\n  async createService(services: LazyServices): Promise<DebugBtn> {\n    let frameLoop = await services.getService<FrameLoop>(\n      \"@aptero/axolotis-core-plugins/modules/FrameLoop\"\n    );\n    return new DebugBtn(frameLoop, services);\n  }\n}\n\nexport class DebugBtn implements Component {\n  constructor(frameLoop: FrameLoop, serviceEntity: LazyServices) {\n    let html =\n      '<div id=\"debug-btn\" style=\"display: block;\\n' +\n      \"    font-family: monospace;\\n\" +\n      \"    cursor: pointer;\\n\" +\n      \"    position: absolute;\\n\" +\n      \"    bottom: 0;\\n\" +\n      \"    right: 2px;\\n\" +\n      \"    padding: 4px 8px;\\n\" +\n      \"    color: #fff;\\n\" +\n      \"    text-shadow: 1px 1px 1px rgba(0,0,0,.5);\\n\" +\n      \"    font-size: 10px;\\n\" +\n      \"    -moz-user-select: none;\\n\" +\n      \"    -webkit-user-select: none;\\n\" +\n      \"    -ms-user-select: none;\\n\" +\n      '    user-select: none\" >60 FPS</div>';\n    window.document.body.insertAdjacentHTML(\"beforeend\", html);\n    let elementById = window.document.getElementById(\"debug-btn\");\n    if (elementById) {\n      elementById.onclick = (evt) => {\n        evt.stopPropagation();\n        evt.preventDefault();\n        serviceEntity.getService<PerformanceStats>(\n          \"@aptero/axolotis-core-plugins/modules/debug/PerformanceStats\"\n        );\n      };\n      frameLoop.addLoop(DebugBtn.name, (delta) => {\n        (elementById as any).innerText =\n          Math.round((1.0 / delta) * 1000) + \" FPS\";\n      });\n    }\n    if (window.location.host.startsWith(\"localhost\")) {\n      serviceEntity.getService<PerformanceStats>(\n        \"@aptero/axolotis-core-plugins/modules/debug/PerformanceStats\"\n      );\n    }\n  }\n\n  getType(): string {\n    return DebugBtn.name;\n  }\n}\n","var Stats = function () {\n\n\tvar mode = 0;\n\n\tvar container = document.createElement( 'div' );\n\tcontainer.style.cssText = 'position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000';\n\tcontainer.addEventListener( 'click', function ( event ) {\n\n\t\tevent.preventDefault();\n\t\tshowPanel( ++ mode % container.children.length );\n\n\t}, false );\n\n\t//\n\n\tfunction addPanel( panel ) {\n\n\t\tcontainer.appendChild( panel.dom );\n\t\treturn panel;\n\n\t}\n\n\tfunction showPanel( id ) {\n\n\t\tfor ( var i = 0; i < container.children.length; i ++ ) {\n\n\t\t\tcontainer.children[ i ].style.display = i === id ? 'block' : 'none';\n\n\t\t}\n\n\t\tmode = id;\n\n\t}\n\n\t//\n\n\tvar beginTime = ( performance || Date ).now(), prevTime = beginTime, frames = 0;\n\n\tvar fpsPanel = addPanel( new Stats.Panel( 'FPS', '#0ff', '#002' ) );\n\tvar msPanel = addPanel( new Stats.Panel( 'MS', '#0f0', '#020' ) );\n\n\tif ( self.performance && self.performance.memory ) {\n\n\t\tvar memPanel = addPanel( new Stats.Panel( 'MB', '#f08', '#201' ) );\n\n\t}\n\n\tshowPanel( 0 );\n\n\treturn {\n\n\t\tREVISION: 16,\n\n\t\tdom: container,\n\n\t\taddPanel: addPanel,\n\t\tshowPanel: showPanel,\n\n\t\tbegin: function () {\n\n\t\t\tbeginTime = ( performance || Date ).now();\n\n\t\t},\n\n\t\tend: function () {\n\n\t\t\tframes ++;\n\n\t\t\tvar time = ( performance || Date ).now();\n\n\t\t\tmsPanel.update( time - beginTime, 200 );\n\n\t\t\tif ( time >= prevTime + 1000 ) {\n\n\t\t\t\tfpsPanel.update( ( frames * 1000 ) / ( time - prevTime ), 100 );\n\n\t\t\t\tprevTime = time;\n\t\t\t\tframes = 0;\n\n\t\t\t\tif ( memPanel ) {\n\n\t\t\t\t\tvar memory = performance.memory;\n\t\t\t\t\tmemPanel.update( memory.usedJSHeapSize / 1048576, memory.jsHeapSizeLimit / 1048576 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn time;\n\n\t\t},\n\n\t\tupdate: function () {\n\n\t\t\tbeginTime = this.end();\n\n\t\t},\n\n\t\t// Backwards Compatibility\n\n\t\tdomElement: container,\n\t\tsetMode: showPanel\n\n\t};\n\n};\n\nStats.Panel = function ( name, fg, bg ) {\n\n\tvar min = Infinity, max = 0, round = Math.round;\n\tvar PR = round( window.devicePixelRatio || 1 );\n\n\tvar WIDTH = 80 * PR, HEIGHT = 48 * PR,\n\t\tTEXT_X = 3 * PR, TEXT_Y = 2 * PR,\n\t\tGRAPH_X = 3 * PR, GRAPH_Y = 15 * PR,\n\t\tGRAPH_WIDTH = 74 * PR, GRAPH_HEIGHT = 30 * PR;\n\n\tvar canvas = document.createElement( 'canvas' );\n\tcanvas.width = WIDTH;\n\tcanvas.height = HEIGHT;\n\tcanvas.style.cssText = 'width:80px;height:48px';\n\n\tvar context = canvas.getContext( '2d' );\n\tcontext.font = 'bold ' + ( 9 * PR ) + 'px Helvetica,Arial,sans-serif';\n\tcontext.textBaseline = 'top';\n\n\tcontext.fillStyle = bg;\n\tcontext.fillRect( 0, 0, WIDTH, HEIGHT );\n\n\tcontext.fillStyle = fg;\n\tcontext.fillText( name, TEXT_X, TEXT_Y );\n\tcontext.fillRect( GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT );\n\n\tcontext.fillStyle = bg;\n\tcontext.globalAlpha = 0.9;\n\tcontext.fillRect( GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT );\n\n\treturn {\n\n\t\tdom: canvas,\n\n\t\tupdate: function ( value, maxValue ) {\n\n\t\t\tmin = Math.min( min, value );\n\t\t\tmax = Math.max( max, value );\n\n\t\t\tcontext.fillStyle = bg;\n\t\t\tcontext.globalAlpha = 1;\n\t\t\tcontext.fillRect( 0, 0, WIDTH, GRAPH_Y );\n\t\t\tcontext.fillStyle = fg;\n\t\t\tcontext.fillText( round( value ) + ' ' + name + ' (' + round( min ) + '-' + round( max ) + ')', TEXT_X, TEXT_Y );\n\n\t\t\tcontext.drawImage( canvas, GRAPH_X + PR, GRAPH_Y, GRAPH_WIDTH - PR, GRAPH_HEIGHT, GRAPH_X, GRAPH_Y, GRAPH_WIDTH - PR, GRAPH_HEIGHT );\n\n\t\t\tcontext.fillRect( GRAPH_X + GRAPH_WIDTH - PR, GRAPH_Y, PR, GRAPH_HEIGHT );\n\n\t\t\tcontext.fillStyle = bg;\n\t\t\tcontext.globalAlpha = 0.9;\n\t\t\tcontext.fillRect( GRAPH_X + GRAPH_WIDTH - PR, GRAPH_Y, PR, round( ( 1 - ( value / maxValue ) ) * GRAPH_HEIGHT ) );\n\n\t\t}\n\n\t};\n\n};\n\nexport default Stats;\n","const html =\n  \"<style>\\n\" +\n  \"    .alarm{\\n\" +\n  \"        color: #b70000;!important;\\n\" +\n  \"    }\\n\" +\n  \"\\n\" +\n  \"    .rs-base h1{\\n\" +\n  \"        margin: 0;\\n\" +\n  \"        padding: 0;\\n\" +\n  \"        font-size: 1.4em;\\n\" +\n  \"        color: #fff;\\n\" +\n  \"        margin-bottom: 5px;\\n\" +\n  \"        cursor: pointer;\\n\" +\n  \"    }\\n\" +\n  \"\\n\" +\n  \"    .rs-base div.rs-group{\\n\" +\n  \"        margin-bottom: 10px;\\n\" +\n  \"    }\\n\" +\n  \"\\n\" +\n  \"    .rs-base div.rs-group.hidden{\\n\" +\n  \"        display: none;\\n\" +\n  \"    }\\n\" +\n  \"\\n\" +\n  \"    .rs-base div.rs-fraction{\\n\" +\n  \"        position: relative;\\n\" +\n  \"        margin-bottom: 5px;\\n\" +\n  \"    }\\n\" +\n  \"\\n\" +\n  \"    .rs-base div.rs-fraction p{\\n\" +\n  \"        width: 120px;\\n\" +\n  \"        text-align: right;\\n\" +\n  \"        margin: 0;\\n\" +\n  \"        padding: 0;\\n\" +\n  \"    }\\n\" +\n  \"\\n\" +\n  \"    .rs-base div.rs-legend{\\n\" +\n  \"        position: absolute;\\n\" +\n  \"        line-height: 1em;\\n\" +\n  \"    }\\n\" +\n  \"\\n\" +\n  \"    .rs-base div.rs-counter-base{\\n\" +\n  \"        position: relative;\\n\" +\n  \"        margin: 2px 0;\\n\" +\n  \"        height: 1em;\\n\" +\n  \"    }\\n\" +\n  \"\\n\" +\n  \"    .rs-base span.rs-counter-id{\\n\" +\n  \"        color: white;\\n\" +\n  \"        position: absolute;\\n\" +\n  \"        left: 0;\\n\" +\n  \"        top: 0;\\n\" +\n  \"    }\\n\" +\n  \"\\n\" +\n  \"    .rs-base div.rs-counter-value{\\n\" +\n  \"        color: white;\\n\" +\n  \"        position: absolute;\\n\" +\n  \"        left: 90px;\\n\" +\n  \"        width: 30px;\\n\" +\n  \"        height: 1em;\\n\" +\n  \"        top: 0;\\n\" +\n  \"        text-align: right;\\n\" +\n  \"    }\\n\" +\n  \"\\n\" +\n  \"    .rs-base canvas.rs-canvas{\\n\" +\n  \"        position: absolute;\\n\" +\n  \"        right: 0;\\n\" +\n  \"    }\\n\" +\n  \"</style>\\n\" +\n  \"<style>\\n\" +\n  \"\\n\" +\n  \"    .rs-header {\\n\" +\n  \"        display: flex;\\n\" +\n  \"        justify-content: space-between;\\n\" +\n  \"        border-bottom: 1px rgba(255,255,255,0.1) solid;\\n\" +\n  \"        margin-bottom: 8px;\\n\" +\n  \"    }\\n\" +\n  \"\\n\" +\n  \"    .rs-collapse-btn {\\n\" +\n  \"        cursor: pointer;\\n\" +\n  \"        font-size: 12px;\\n\" +\n  \"    }\\n\" +\n  \"\\n\" +\n  \"    .rs-fps-counter {\\n\" +\n  \"        font-family: monospace;\\n\" +\n  \"        cursor: pointer;\\n\" +\n  \"        position: absolute;\\n\" +\n  \"        bottom: 96px;\\n\" +\n  \"        right: 2px;\\n\" +\n  \"        padding: 4px 8px;\\n\" +\n  \"        color: #ffffff;\\n\" +\n  \"        text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.5);\\n\" +\n  \"        font-size: 10px;\\n\" +\n  \"        -moz-user-select: none;\\n\" +\n  \"        -webkit-user-select: none;\\n\" +\n  \"        -ms-user-select: none;\\n\" +\n  \"        user-select: none;\\n\" +\n  \"    }\\n\" +\n  \"\\n\" +\n  \"    .rs-base {\\n\" +\n  \"        right: 10px;\\n\" +\n  \"        left: auto;\\n\" +\n  \"        top: 10px;\\n\" +\n  \"        -moz-user-select: none;\\n\" +\n  \"        -webkit-user-select: none;\\n\" +\n  \"        -ms-user-select: none;\\n\" +\n  \"        user-select: none;\\n\" +\n  \"\\n\" +\n  \"        position: absolute;\\n\" +\n  \"        z-index: 10000;\\n\" +\n  \"        padding: 10px;\\n\" +\n  \"        background-color: #222;\\n\" +\n  \"        font-size: 10px;\\n\" +\n  \"        line-height: 1.2em;\\n\" +\n  \"        width: 350px;\\n\" +\n  \"        font-family: 'Roboto Condensed', tahoma, sans-serif;\\n\" +\n  \"        overflow: hidden;\\n\" +\n  \"    }\\n\" +\n  \"</style>\\n\";\nimport { WebpackLazyModule } from \"@aptero/axolotis-player/build/types/modules/core/loader/WebpackLoader\";\nimport {\n  LazyServices,\n  Service,\n} from \"@aptero/axolotis-player/build/types/modules/core/service/LazyServices\";\nimport Component from \"@aptero/axolotis-player/build/types/modules/core/ecs/Component\";\nimport Stats from \"three/examples/jsm/libs/stats.module\";\nimport { FrameLoop } from \"@aptero/axolotis-player\";\nimport { WorldService } from \"@aptero/axolotis-player/build/types/modules/core/WorldService\";\n//import { ServiceEntity } from \"@aptero/axolotis-player/build/types/modules/core/service/ServiceEntity\";\nimport { ServiceEntity } from \"@aptero/axolotis-player\";\nimport { ThreeLib } from \"@root/lib/modules/three/ThreeLib\";\nimport NavMeshPlayer from \"@root/lib/modules/controller/pathFindingPlayer/NavMeshPlayer\";\nimport { DebugBtn } from \"@root/lib/modules/debug/DebugBtn\";\n//import {PortalsService} from \"@aptero/axolotis-core-plugins/modules/portals/PortalsService\";\n\nconst rStats = require(\"./rStats/rStats\");\nconst rStatsExtra = require(\"./rStats/rStats.extras\");\n\ndeclare const window: any;\n\nexport class Factory implements WebpackLazyModule, Service<PerformanceStats> {\n  async createService(services: LazyServices): Promise<PerformanceStats> {\n    let threeLib = await services.getService<ThreeLib>(\n      \"@aptero/axolotis-core-plugins/modules/three/ThreeLib\"\n    );\n    let frameLoop = await services.getService<FrameLoop>(\n      \"@aptero/axolotis-core-plugins/modules/FrameLoop\"\n    );\n    let worldService = await services.getService<WorldService>(\n      \"@aptero/axolotis-core-plugins/modules/core/WorldService\"\n    );\n    return new PerformanceStats(threeLib, frameLoop, worldService);\n  }\n}\n\nexport class PerformanceStats implements Component {\n  private rS: any;\n  constructor(\n    private threeLib: ThreeLib,\n    frameLoop: FrameLoop,\n    private worldService: WorldService\n  ) {\n    console.warn(\n      \"MB MBytes of allocated memory. (Run Chrome with --enable-precise-memory-info) to have precise perf info\"\n    );\n    const stats = Stats();\n    stats.showPanel(2);\n    document.body.appendChild(stats.dom);\n    this.updateRstats();\n    window.document.body.insertAdjacentHTML(\"beforeend\", html);\n    if (worldService.isActiveWorld()) {\n      const animate = (t) => {\n        //Avoir using frameloop for this so it does not appear on perf\n        requestAnimationFrame(animate);\n        stats.update();\n        this.rS().update();\n        this.rS(\"framerate\").end();\n        this.rS(\"framerate\").start();\n      };\n      requestAnimationFrame(animate);\n    }\n\n    worldService.addOnWorldAdded(() => {\n      this.updateWorldCallback();\n    }, true);\n  }\n\n  updateRstats() {\n    let elementsByClassName = document.body.getElementsByClassName(\"rs-base\");\n    if (elementsByClassName.length != 0) {\n      elementsByClassName[0].remove();\n    }\n    //https://spite.github.io/rstats/\n    const threeStats = new window.threeStats(this.threeLib.renderer);\n    //const glS = new window.glStats(); // init at any point\n    const plugins = [threeStats];\n    let config: any = {\n      css: [], // Our stylesheet is injected from AFrame.\n      values: {\n        framerate: { caption: \"Frame (ms)\", over: 19 }, //17 ms = 60fps\n      },\n      groups: [],\n      plugins: plugins,\n    };\n    for (let i = 0; i < this.worldService.getWorlds().length; i++) {\n      config.values[FrameLoop.name.toLowerCase() + \"-\" + i] = {\n        caption: FrameLoop.name + \" (ms)\",\n        over: 10,\n      };\n      config.values[ThreeLib.name.toLowerCase() + \"-\" + i] = {\n        caption: ThreeLib.name + \" (ms)\",\n      };\n      config.values[NavMeshPlayer.name.toLowerCase() + \"-\" + i] = {\n        caption: NavMeshPlayer.name + \" (ms)\",\n      };\n      config.values[DebugBtn.name.toLowerCase() + \"-\" + i] = {\n        caption: DebugBtn.name + \" (ms)\",\n      };\n      config.values[PerformanceStats.name.toLowerCase() + \"-\" + i] = {\n        caption: PerformanceStats.name + \" (ms)\",\n      };\n      //config.values[PortalsService.name.toLowerCase()+\"-\"+i] = { caption: PortalsService.name + \" (ms)\" };\n      config.groups.push({\n        caption: \"World - \" + i,\n        values: [\n          FrameLoop.name.toLowerCase() + \"-\" + i,\n          ThreeLib.name.toLowerCase() + \"-\" + i,\n          NavMeshPlayer.name.toLowerCase() + \"-\" + i,\n        ],\n        //PortalsService.name.toLowerCase()+\"-\"+i]\n      });\n    }\n    this.rS = new rStats(config);\n  }\n\n  updateWorldCallback() {\n    console.log(\"new world :\", this.worldService.getWorlds());\n    this.updateRstats();\n    this.worldService.getWorlds().forEach(async (world, index) => {\n      let services = world.getFirstComponentByType<ServiceEntity>(\n        ServiceEntity.name\n      );\n      let frameLoop = await services.getService<FrameLoop>(\n        \"@aptero/axolotis-core-plugins/modules/FrameLoop\"\n      );\n      frameLoop.setMonitoringCallback(\n        (name) => {\n          this.rS(name.toLowerCase() + \"-\" + index).start();\n        },\n        (name) => {\n          this.rS(name.toLowerCase() + \"-\" + index).end();\n        }\n      );\n    });\n  }\n\n  getType(): string {\n    return PerformanceStats.name;\n  }\n}\n","// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-nocheck\nwindow.glStats = function () {\n  var _rS = null;\n\n  var _totalDrawArraysCalls = 0,\n    _totalDrawElementsCalls = 0,\n    _totalUseProgramCalls = 0,\n    _totalFaces = 0,\n    _totalVertices = 0,\n    _totalPoints = 0,\n    _totalBindTexures = 0;\n\n  function _h(f, c) {\n    return function () {\n      c.apply(this, arguments);\n      f.apply(this, arguments);\n    };\n  }\n\n  WebGLRenderingContext.prototype.drawArrays = _h(\n    WebGLRenderingContext.prototype.drawArrays,\n    function () {\n      _totalDrawArraysCalls++;\n      if (arguments[0] == this.POINTS) _totalPoints += arguments[2];\n      else _totalVertices += arguments[2];\n    }\n  );\n\n  WebGLRenderingContext.prototype.drawElements = _h(\n    WebGLRenderingContext.prototype.drawElements,\n    function () {\n      _totalDrawElementsCalls++;\n      _totalFaces += arguments[1] / 3;\n      _totalVertices += arguments[1];\n    }\n  );\n\n  WebGLRenderingContext.prototype.useProgram = _h(\n    WebGLRenderingContext.prototype.useProgram,\n    function () {\n      _totalUseProgramCalls++;\n    }\n  );\n\n  WebGLRenderingContext.prototype.bindTexture = _h(\n    WebGLRenderingContext.prototype.bindTexture,\n    function () {\n      _totalBindTexures++;\n    }\n  );\n\n  var _values = {\n    allcalls: {\n      over: 3000,\n      caption: \"Calls (hook)\",\n    },\n    drawelements: {\n      caption: \"drawElements (hook)\",\n    },\n    drawarrays: {\n      caption: \"drawArrays (hook)\",\n    },\n  };\n\n  var _groups = [\n    {\n      caption: \"WebGL\",\n      values: [\n        \"allcalls\",\n        \"drawelements\",\n        \"drawarrays\",\n        \"useprogram\",\n        \"bindtexture\",\n        \"glfaces\",\n        \"glvertices\",\n        \"glpoints\",\n      ],\n    },\n  ];\n\n  var _fractions = [\n    {\n      base: \"allcalls\",\n      steps: [\"drawelements\", \"drawarrays\"],\n    },\n  ];\n\n  function _update() {\n    _rS(\"allcalls\").set(_totalDrawArraysCalls + _totalDrawElementsCalls);\n    _rS(\"drawElements\").set(_totalDrawElementsCalls);\n    _rS(\"drawArrays\").set(_totalDrawArraysCalls);\n    _rS(\"bindTexture\").set(_totalBindTexures);\n    _rS(\"useProgram\").set(_totalUseProgramCalls);\n    _rS(\"glfaces\").set(_totalFaces);\n    _rS(\"glvertices\").set(_totalVertices);\n    _rS(\"glpoints\").set(_totalPoints);\n  }\n\n  function _start() {\n    _totalDrawArraysCalls = 0;\n    _totalDrawElementsCalls = 0;\n    _totalUseProgramCalls = 0;\n    _totalFaces = 0;\n    _totalVertices = 0;\n    _totalPoints = 0;\n    _totalBindTexures = 0;\n  }\n\n  function _end() {}\n\n  function _attach(r) {\n    _rS = r;\n  }\n\n  return {\n    update: _update,\n    start: _start,\n    end: _end,\n    attach: _attach,\n    values: _values,\n    groups: _groups,\n    fractions: _fractions,\n  };\n};\n\nwindow.threeStats = function (renderer) {\n  var _rS = null;\n\n  var _values = {\n    \"renderer.info.memory.geometries\": {\n      caption: \"Geometries\",\n    },\n    \"renderer.info.memory.textures\": {\n      caption: \"Textures\",\n    },\n    \"renderer.info.programs\": {\n      caption: \"Programs\",\n    },\n    \"renderer.info.render.calls\": {\n      caption: \"Calls\",\n    },\n    \"renderer.info.render.triangles\": {\n      caption: \"Triangles\",\n      over: 300000,\n    },\n    \"renderer.info.render.points\": {\n      caption: \"Points\",\n    },\n  };\n\n  var _groups = [\n    {\n      caption: \"Three.js - Memory\",\n      values: [\n        \"renderer.info.memory.geometries\",\n        \"renderer.info.programs\",\n        \"renderer.info.memory.textures\",\n      ],\n    },\n    {\n      caption: \"Three.js - Render\",\n      values: [\n        \"renderer.info.render.calls\",\n        \"renderer.info.render.triangles\",\n        \"renderer.info.render.points\",\n      ],\n    },\n  ];\n\n  var _fractions = [];\n\n  function _update() {\n    _rS(\"renderer.info.memory.geometries\").set(renderer.info.memory.geometries);\n    _rS(\"renderer.info.programs\").set(renderer.info.programs.length);\n    _rS(\"renderer.info.memory.textures\").set(renderer.info.memory.textures);\n    _rS(\"renderer.info.render.calls\").set(renderer.info.render.calls);\n    _rS(\"renderer.info.render.triangles\").set(renderer.info.render.triangles);\n    _rS(\"renderer.info.render.points\").set(renderer.info.render.points);\n  }\n\n  function _start() {}\n\n  function _end() {}\n\n  function _attach(r) {\n    _rS = r;\n  }\n\n  return {\n    update: _update,\n    start: _start,\n    end: _end,\n    attach: _attach,\n    values: _values,\n    groups: _groups,\n    fractions: _fractions,\n  };\n};\n\n/*\n *   From https://github.com/paulirish/memory-stats.js\n */\n\nwindow.BrowserStats = function () {\n  var _rS = null;\n\n  var _usedJSHeapSize = 0,\n    _totalJSHeapSize = 0;\n\n  if (window.performance && !performance.memory) {\n    performance.memory = {\n      usedJSHeapSize: 0,\n      totalJSHeapSize: 0,\n    };\n  }\n\n  if (performance.memory.totalJSHeapSize === 0) {\n    console.warn(\n      \"totalJSHeapSize === 0... performance.memory is only available in Chrome .\"\n    );\n  }\n\n  var _values = {\n    memory: {\n      caption: \"Used Memory\",\n      average: true,\n      avgMs: 1000,\n      over: 22,\n    },\n    total: {\n      caption: \"Total Memory\",\n    },\n  };\n\n  var _groups = [\n    {\n      caption: \"Browser\",\n      values: [\"memory\", \"total\"],\n    },\n  ];\n\n  var _fractions = [\n    {\n      base: \"total\",\n      steps: [\"memory\"],\n    },\n  ];\n\n  var log1024 = Math.log(1024);\n\n  function _size(v) {\n    var precision = 100; //Math.pow(10, 2);\n    var i = Math.floor(Math.log(v) / log1024);\n    return Math.round((v * precision) / Math.pow(1024, i)) / precision; // + ' ' + sizes[i];\n  }\n\n  function _update() {\n    _usedJSHeapSize = _size(performance.memory.usedJSHeapSize);\n    _totalJSHeapSize = _size(performance.memory.totalJSHeapSize);\n\n    _rS(\"memory\").set(_usedJSHeapSize);\n    _rS(\"total\").set(_totalJSHeapSize);\n  }\n\n  function _start() {\n    _usedJSHeapSize = 0;\n  }\n\n  function _end() {}\n\n  function _attach(r) {\n    _rS = r;\n  }\n\n  return {\n    update: _update,\n    start: _start,\n    end: _end,\n    attach: _attach,\n    values: _values,\n    groups: _groups,\n    fractions: _fractions,\n  };\n};\n\nif (typeof module === \"object\") {\n  module.exports = {\n    glStats: window.glStats,\n    threeStats: window.threeStats,\n    BrowserStats: window.BrowserStats,\n  };\n}\n","// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-nocheck\n// performance.now() polyfill from https://gist.github.com/paulirish/5438650\n\"use strict\";\n\n(function () {\n  if (\"performance\" in window == false) {\n    window.performance = {};\n  }\n\n  var performance = window.performance;\n\n  if (\"now\" in performance == false) {\n    var nowOffset = Date.now();\n\n    if (performance.timing && performance.timing.navigationStart) {\n      nowOffset = performance.timing.navigationStart;\n    }\n\n    performance.now = function now() {\n      return Date.now() - nowOffset;\n    };\n  }\n\n  if (!performance.mark) {\n    performance.mark = function () {};\n  }\n\n  if (!performance.measure) {\n    performance.measure = function () {};\n  }\n})();\n\nwindow.rStats = function rStats(settings) {\n  function iterateKeys(array, callback) {\n    var keys = Object.keys(array);\n    for (var j = 0, l = keys.length; j < l; j++) {\n      callback(keys[j]);\n    }\n  }\n\n  function importCSS(url) {\n    var element = document.createElement(\"link\");\n    element.href = url;\n    element.rel = \"stylesheet\";\n    element.type = \"text/css\";\n    document.getElementsByTagName(\"head\")[0].appendChild(element);\n  }\n\n  var _settings = settings || {};\n  var _colours = _settings.colours || [\n    \"#850700\",\n    \"#c74900\",\n    \"#fcb300\",\n    \"#284280\",\n    \"#4c7c0c\",\n  ];\n\n  var _cssFont =\n    \"https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300\";\n  var _cssRStats = (_settings.CSSPath ? _settings.CSSPath : \"\") + \"rStats.css\";\n\n  var _css = _settings.css || [_cssFont, _cssRStats];\n  _css.forEach(function (uri) {\n    importCSS(uri);\n  });\n\n  if (!_settings.values) _settings.values = {};\n\n  var _base,\n    _div,\n    _elHeight = 10,\n    _elWidth = 200;\n  var _perfCounters = {};\n\n  function Graph(_dom, _id, _defArg) {\n    var _def = _defArg || {};\n    var _canvas = document.createElement(\"canvas\"),\n      _ctx = _canvas.getContext(\"2d\"),\n      _max = 0,\n      _current = 0;\n\n    var c = _def.color ? _def.color : \"#666666\";\n\n    var _dotCanvas = document.createElement(\"canvas\"),\n      _dotCtx = _dotCanvas.getContext(\"2d\");\n    _dotCanvas.width = 1;\n    _dotCanvas.height = 2 * _elHeight;\n    _dotCtx.fillStyle = \"#444444\";\n    _dotCtx.fillRect(0, 0, 1, 2 * _elHeight);\n    _dotCtx.fillStyle = c;\n    _dotCtx.fillRect(0, _elHeight, 1, _elHeight);\n    _dotCtx.fillStyle = \"#ffffff\";\n    _dotCtx.globalAlpha = 0.5;\n    _dotCtx.fillRect(0, _elHeight, 1, 1);\n    _dotCtx.globalAlpha = 1;\n\n    var _alarmCanvas = document.createElement(\"canvas\"),\n      _alarmCtx = _alarmCanvas.getContext(\"2d\");\n    _alarmCanvas.width = 1;\n    _alarmCanvas.height = 2 * _elHeight;\n    _alarmCtx.fillStyle = \"#444444\";\n    _alarmCtx.fillRect(0, 0, 1, 2 * _elHeight);\n    _alarmCtx.fillStyle = \"#b70000\";\n    _alarmCtx.fillRect(0, _elHeight, 1, _elHeight);\n    _alarmCtx.globalAlpha = 0.5;\n    _alarmCtx.fillStyle = \"#ffffff\";\n    _alarmCtx.fillRect(0, _elHeight, 1, 1);\n    _alarmCtx.globalAlpha = 1;\n\n    function _init() {\n      _canvas.width = _elWidth;\n      _canvas.height = _elHeight;\n      _canvas.style.width = _canvas.width + \"px\";\n      _canvas.style.height = _canvas.height + \"px\";\n      _canvas.className = \"rs-canvas\";\n      _dom.appendChild(_canvas);\n\n      _ctx.fillStyle = \"#444444\";\n      _ctx.fillRect(0, 0, _canvas.width, _canvas.height);\n    }\n\n    function _draw(v, alarm) {\n      _current += (v - _current) * 0.1;\n      _max *= 0.99;\n      if (_current > _max) _max = _current;\n      _ctx.drawImage(\n        _canvas,\n        1,\n        0,\n        _canvas.width - 1,\n        _canvas.height,\n        0,\n        0,\n        _canvas.width - 1,\n        _canvas.height\n      );\n      if (alarm) {\n        _ctx.drawImage(\n          _alarmCanvas,\n          _canvas.width - 1,\n          _canvas.height - (_current * _canvas.height) / _max - _elHeight\n        );\n      } else {\n        _ctx.drawImage(\n          _dotCanvas,\n          _canvas.width - 1,\n          _canvas.height - (_current * _canvas.height) / _max - _elHeight\n        );\n      }\n    }\n\n    _init();\n\n    return {\n      draw: _draw,\n    };\n  }\n\n  function StackGraph(_dom, _num) {\n    var _canvas = document.createElement(\"canvas\"),\n      _ctx = _canvas.getContext(\"2d\");\n\n    function _init() {\n      _canvas.width = _elWidth;\n      _canvas.height = _elHeight * _num;\n      _canvas.style.width = _canvas.width + \"px\";\n      _canvas.style.height = _canvas.height + \"px\";\n      _canvas.className = \"rs-canvas\";\n      _dom.appendChild(_canvas);\n\n      _ctx.fillStyle = \"#444444\";\n      _ctx.fillRect(0, 0, _canvas.width, _canvas.height);\n    }\n\n    function _draw(v) {\n      _ctx.drawImage(\n        _canvas,\n        1,\n        0,\n        _canvas.width - 1,\n        _canvas.height,\n        0,\n        0,\n        _canvas.width - 1,\n        _canvas.height\n      );\n      var th = 0;\n      iterateKeys(v, function (j) {\n        var h = v[j] * _canvas.height;\n        _ctx.fillStyle = _colours[j];\n        _ctx.fillRect(_canvas.width - 1, th, 1, h);\n        th += h;\n      });\n    }\n\n    _init();\n\n    return {\n      draw: _draw,\n    };\n  }\n\n  function PerfCounter(id, group) {\n    var _id = id,\n      _time,\n      _value = 0,\n      _total = 0,\n      _averageValue = 0,\n      _accumValue = 0,\n      _accumStart = performance.now(),\n      _accumSamples = 0,\n      _dom = document.createElement(\"div\"),\n      _spanId = document.createElement(\"span\"),\n      _spanValue = document.createElement(\"div\"),\n      _spanValueText = document.createTextNode(\"\"),\n      _def = _settings ? _settings.values[_id.toLowerCase()] : null,\n      _graph = new Graph(_dom, _id, _def),\n      _started = false;\n\n    _spanId.className = \"rs-counter-id\";\n    _spanId.textContent = _def && _def.caption ? _def.caption : _id;\n\n    _spanValue.className = \"rs-counter-value\";\n    _spanValue.appendChild(_spanValueText);\n\n    _dom.appendChild(_spanId);\n    _dom.appendChild(_spanValue);\n    if (group) group.div.appendChild(_dom);\n    else _div.appendChild(_dom);\n\n    _time = performance.now();\n\n    function _average(v) {\n      if (_def && _def.average) {\n        _accumValue += v;\n        _accumSamples++;\n        var t = performance.now();\n        if (t - _accumStart >= (_def.avgMs || 1000)) {\n          _averageValue = _accumValue / _accumSamples;\n          _accumValue = 0;\n          _accumStart = t;\n          _accumSamples = 0;\n        }\n      }\n    }\n\n    function _start() {\n      _time = performance.now();\n      if (_settings.userTimingAPI) performance.mark(_id + \"-start\");\n      _started = true;\n    }\n\n    function _end() {\n      _value = performance.now() - _time;\n      if (_settings.userTimingAPI) {\n        performance.mark(_id + \"-end\");\n        if (_started) {\n          performance.measure(_id, _id + \"-start\", _id + \"-end\");\n        }\n      }\n      _average(_value);\n    }\n\n    function _tick() {\n      _end();\n      _start();\n    }\n\n    function _draw() {\n      var v = _def && _def.average ? _averageValue : _value;\n      _spanValueText.nodeValue = Math.round(v * 100) / 100;\n      var a =\n        _def &&\n        ((_def.below && _value < _def.below) ||\n          (_def.over && _value > _def.over));\n      _graph.draw(_value, a);\n      _dom.className = a ? \"rs-counter-base alarm\" : \"rs-counter-base\";\n    }\n\n    function _frame() {\n      var t = performance.now();\n      var e = t - _time;\n      _total++;\n      if (e > 1000) {\n        if (_def && _def.interpolate === false) {\n          _value = _total;\n        } else {\n          _value = (_total * 1000) / e;\n        }\n        _total = 0;\n        _time = t;\n        _average(_value);\n      }\n    }\n\n    function _set(v) {\n      _value = v;\n      _average(_value);\n    }\n\n    return {\n      set: _set,\n      start: _start,\n      tick: _tick,\n      end: _end,\n      frame: _frame,\n      value: function () {\n        return _value;\n      },\n      draw: _draw,\n    };\n  }\n\n  function sample() {\n    var _value = 0;\n\n    function _set(v) {\n      _value = v;\n    }\n\n    return {\n      set: _set,\n      value: function () {\n        return _value;\n      },\n    };\n  }\n\n  function _perf(idArg) {\n    var id = idArg.toLowerCase();\n    if (id === undefined) id = \"default\";\n    if (_perfCounters[id]) return _perfCounters[id];\n\n    var group = null;\n    if (_settings && _settings.groups) {\n      iterateKeys(_settings.groups, function (j) {\n        var g = _settings.groups[parseInt(j, 10)];\n        if (!group && g.values.indexOf(id.toLowerCase()) !== -1) {\n          group = g;\n        }\n      });\n    }\n\n    var p = new PerfCounter(id, group);\n    _perfCounters[id] = p;\n    return p;\n  }\n\n  function _init() {\n    if (_settings.plugins) {\n      if (!_settings.values) _settings.values = {};\n      if (!_settings.groups) _settings.groups = [];\n      if (!_settings.fractions) _settings.fractions = [];\n      for (var j = 0; j < _settings.plugins.length; j++) {\n        _settings.plugins[j].attach(_perf);\n        iterateKeys(_settings.plugins[j].values, function (k) {\n          _settings.values[k] = _settings.plugins[j].values[k];\n        });\n        _settings.groups = _settings.groups.concat(_settings.plugins[j].groups);\n        _settings.fractions = _settings.fractions.concat(\n          _settings.plugins[j].fractions\n        );\n      }\n    } else {\n      _settings.plugins = {};\n    }\n\n    _base = document.createElement(\"div\");\n    _base.className = \"rs-base\";\n    _div = document.createElement(\"div\");\n    _div.className = \"rs-container\";\n    _div.style.height = \"auto\";\n    _base.appendChild(_div);\n    document.body.appendChild(_base);\n\n    if (!_settings) return;\n\n    if (_settings.groups) {\n      iterateKeys(_settings.groups, function (j) {\n        var g = _settings.groups[parseInt(j, 10)];\n        var div = document.createElement(\"div\");\n        div.className = \"rs-group\";\n        g.div = div;\n        var h1 = document.createElement(\"h1\");\n        h1.textContent = g.caption;\n        h1.addEventListener(\n          \"click\",\n          function (e) {\n            this.classList.toggle(\"hidden\");\n            e.preventDefault();\n          }.bind(div)\n        );\n        _div.appendChild(h1);\n        _div.appendChild(div);\n      });\n    }\n\n    if (_settings.fractions) {\n      iterateKeys(_settings.fractions, function (j) {\n        var f = _settings.fractions[parseInt(j, 10)];\n        var div = document.createElement(\"div\");\n        div.className = \"rs-fraction\";\n        var legend = document.createElement(\"div\");\n        legend.className = \"rs-legend\";\n\n        var h = 0;\n        iterateKeys(_settings.fractions[j].steps, function (k) {\n          var p = document.createElement(\"p\");\n          p.textContent = _settings.fractions[j].steps[k];\n          p.style.color = _colours[h];\n          legend.appendChild(p);\n          h++;\n        });\n        div.appendChild(legend);\n        div.style.height = h * _elHeight + \"px\";\n        f.div = div;\n        var graph = new StackGraph(div, h);\n        f.graph = graph;\n        _div.appendChild(div);\n      });\n    }\n  }\n\n  function _update() {\n    iterateKeys(_settings.plugins, function (j) {\n      _settings.plugins[j].update();\n    });\n\n    iterateKeys(_perfCounters, function (j) {\n      _perfCounters[j].draw();\n    });\n\n    if (_settings && _settings.fractions) {\n      iterateKeys(_settings.fractions, function (j) {\n        var f = _settings.fractions[parseInt(j, 10)];\n        var v = [];\n        var base = _perfCounters[f.base.toLowerCase()];\n        if (base) {\n          base = base.value();\n          iterateKeys(_settings.fractions[j].steps, function (k) {\n            var s = _settings.fractions[j].steps[parseInt(k, 10)].toLowerCase();\n            var val = _perfCounters[s];\n            if (val) {\n              v.push(val.value() / base);\n            }\n          });\n        }\n        f.graph.draw(v);\n      });\n    }\n\n    /*if( _height != _div.clientHeight ) {\n            _height = _div.clientHeight;\n            _base.style.height = _height + 2 * _elHeight + 'px';\n        console.log( _base.clientHeight );\n        }*/\n  }\n\n  _init();\n\n  return function (id) {\n    if (id) return _perf(id);\n    return {\n      element: _base,\n      update: _update,\n    };\n  };\n};\n\nif (typeof module === \"object\") {\n  module.exports = window.rStats;\n}\n","export class AssetsLoader {\n  loaderCache = {};\n  assets = {};\n\n  async getLoader(loaderName: string, loaderLoader: () => void) {\n    if (!this.loaderCache[loaderName]) {\n      this.loaderCache[loaderName] = await loaderLoader();\n    }\n    return this.loaderCache[loaderName];\n  }\n}\n\nexport const assetsLoader: AssetsLoader = new AssetsLoader();\n","import * as THREE from \"three\";\n\nimport { assetsLoader } from \"@root/lib/modules/three/ThreeAssetsLoader\";\nimport Component from \"@aptero/axolotis-player/build/types/modules/core/ecs/Component\";\nimport { WebpackLazyModule } from \"@aptero/axolotis-player/build/types/modules/core/loader/WebpackLoader\";\nimport {\n  FrameLoop,\n  LazyServices,\n  WorldService,\n} from \"@aptero/axolotis-player/build/types\";\nimport { Service } from \"@aptero/axolotis-player/build/types/modules/core/service/LazyServices\";\n\ndeclare let window: any;\nexport function getGlobalRenderer() {\n  if (!window.axolotis?.renderer) {\n    let renderer = new THREE.WebGLRenderer({ antialias: true });\n    renderer.setSize(window.innerWidth, window.innerHeight);\n\n    renderer.toneMapping = THREE.ACESFilmicToneMapping;\n    renderer.toneMappingExposure = 1;\n    renderer.outputEncoding = THREE.sRGBEncoding;\n    renderer.setPixelRatio(window.devicePixelRatio);\n\n    document.body.appendChild(renderer.domElement);\n    if (!window.axolotis) {\n      window.axolotis = {};\n    }\n    window.axolotis.renderer = renderer;\n  }\n  return window.axolotis.renderer;\n}\n\nexport class ThreeLib implements Component {\n  renderer: THREE.WebGLRenderer;\n  scene: THREE.Scene;\n  camera: THREE.PerspectiveCamera;\n  preRenderPass: (() => void)[] = [];\n  constructor(frameLoop: FrameLoop, worldService: WorldService) {\n    this.scene = new THREE.Scene();\n\n    this.renderer = getGlobalRenderer();\n\n    this.camera = new THREE.PerspectiveCamera(\n      75,\n      window.innerWidth / window.innerHeight,\n      0.001,\n      100000\n    );\n    this.camera.position.z = 2;\n\n    const render = () => {\n      for (const prerender of this.preRenderPass) {\n        prerender();\n      }\n      // FINAL PASS\n      this.renderer.render(this.scene, this.camera);\n      // set things back to normal\n      this.renderer.autoClear = true;\n    };\n\n    const onWindowResize = () => {\n      this.camera.aspect = window.innerWidth / window.innerHeight;\n      this.camera.updateProjectionMatrix();\n      this.renderer.setSize(window.innerWidth, window.innerHeight);\n      render();\n    };\n\n    worldService.addOnWorldChangeCallback(() => {\n      window.removeEventListener(\"resize\", onWindowResize);\n      frameLoop.removeLoop(ThreeLib.name);\n      if (worldService.isActiveWorld()) {\n        window.addEventListener(\"resize\", onWindowResize, false);\n        frameLoop.addLoop(ThreeLib.name, render);\n      }\n    }, true);\n  }\n\n  async loadAssets(path: string) {\n    if (assetsLoader.assets[path]) {\n      return assetsLoader.assets[path];\n    }\n    /*\n    TODO createa a early start download of assets so that the GLB start downloading early in the waterfall\n    Not as simple as it seems may be doable using service worker\n    fetch(path);//start download of assets\n    var oReq = new XMLHttpRequest();\n    oReq.addEventListener(\"load\", ()=>{});\n    oReq.open(\"GET\", path);\n    oReq.send();\n    */\n    if (path.endsWith(\".glb\")) {\n      const loader = await assetsLoader.getLoader(\"GLTFLoader\", async () => {\n        const GLTFLoader: any = await import(\n          \"three/examples/jsm/loaders/GLTFLoader\"\n        );\n        const gltfLoader = new GLTFLoader.GLTFLoader();\n        return gltfLoader;\n      });\n      const result = await loader.loadAsync(path);\n      assetsLoader.assets[path] = result;\n    }\n    if (path.endsWith(\".jpg\")) {\n      const loader = await assetsLoader.getLoader(\"TextureLoader\", async () => {\n        const THREE: any = await import(\"three\");\n        const texLoader = new THREE.TextureLoader();\n        return texLoader;\n      });\n      const result = await loader.loadAsync(path);\n      assetsLoader.assets[path] = result;\n    }\n    return assetsLoader.assets[path];\n  }\n\n  getType(): string {\n    return ThreeLib.name;\n  }\n}\n\nexport class Factory implements WebpackLazyModule, Service<ThreeLib> {\n  constructor() {}\n\n  async createService(services: LazyServices): Promise<ThreeLib> {\n    let frameLoop = await services.getService<FrameLoop>(\n      \"@aptero/axolotis-core-plugins/modules/FrameLoop\"\n    );\n    let worldService = await services.getService<WorldService>(\n      \"@aptero/axolotis-core-plugins/modules/core/WorldService\"\n    );\n    return new ThreeLib(frameLoop, worldService);\n  }\n}\n"],"names":["Factory","services","frameLoop","getService","DebugBtn","constructor","serviceEntity","window","document","body","insertAdjacentHTML","elementById","getElementById","onclick","evt","stopPropagation","preventDefault","addLoop","name","delta","innerText","Math","round","location","host","startsWith","getType","Stats","mode","container","createElement","addPanel","panel","appendChild","dom","showPanel","id","i","children","length","style","display","cssText","addEventListener","event","beginTime","performance","Date","now","prevTime","frames","fpsPanel","Panel","msPanel","self","memory","memPanel","REVISION","begin","end","time","update","usedJSHeapSize","jsHeapSizeLimit","this","domElement","setMode","fg","bg","min","Infinity","max","PR","devicePixelRatio","WIDTH","HEIGHT","TEXT_X","TEXT_Y","GRAPH_X","GRAPH_Y","GRAPH_WIDTH","GRAPH_HEIGHT","canvas","width","height","context","getContext","font","textBaseline","fillStyle","fillRect","fillText","globalAlpha","value","maxValue","drawImage","rStats","require","threeLib","worldService","PerformanceStats","console","warn","stats","updateRstats","isActiveWorld","animate","t","requestAnimationFrame","rS","start","addOnWorldAdded","updateWorldCallback","elementsByClassName","getElementsByClassName","remove","config","css","values","framerate","caption","over","groups","plugins","threeStats","renderer","getWorlds","FrameLoop","ThreeLib","NavMeshPlayer","toLowerCase","push","log","forEach","async","world","index","getFirstComponentByType","ServiceEntity","setMonitoringCallback","glStats","_rS","_totalDrawArraysCalls","_totalDrawElementsCalls","_totalUseProgramCalls","_totalFaces","_totalVertices","_totalPoints","_totalBindTexures","_h","f","c","apply","arguments","WebGLRenderingContext","prototype","drawArrays","POINTS","drawElements","useProgram","bindTexture","set","attach","r","allcalls","drawelements","drawarrays","fractions","base","steps","info","geometries","programs","textures","render","calls","triangles","points","BrowserStats","_usedJSHeapSize","_totalJSHeapSize","totalJSHeapSize","log1024","_size","v","floor","pow","average","avgMs","total","module","exports","nowOffset","timing","navigationStart","mark","measure","settings","iterateKeys","array","callback","keys","Object","j","l","_settings","_colours","colours","_cssRStats","CSSPath","uri","url","element","href","rel","type","getElementsByTagName","_base","_div","_elHeight","_perfCounters","Graph","_dom","_id","_defArg","_def","_canvas","_ctx","_max","_current","color","_dotCanvas","_dotCtx","_alarmCanvas","_alarmCtx","className","draw","alarm","StackGraph","_num","th","h","PerfCounter","group","_time","_value","_total","_averageValue","_accumValue","_accumStart","_accumSamples","_spanId","_spanValue","_spanValueText","createTextNode","_graph","_started","_average","_start","userTimingAPI","_end","textContent","div","tick","frame","e","interpolate","nodeValue","a","below","_perf","idArg","undefined","g","parseInt","indexOf","p","_update","k","s","val","graph","concat","h1","classList","toggle","bind","legend","_init","assetsLoader","loaderName","loaderLoader","loaderCache","getGlobalRenderer","axolotis","THREE","antialias","setSize","innerWidth","innerHeight","toneMapping","toneMappingExposure","outputEncoding","setPixelRatio","scene","camera","position","z","prerender","preRenderPass","autoClear","onWindowResize","aspect","updateProjectionMatrix","addOnWorldChangeCallback","removeEventListener","removeLoop","path","assets","endsWith","loader","getLoader","GLTFLoader","result","loadAsync","TextureLoader"],"sourceRoot":""}