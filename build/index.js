/*!
 * 
 *   @aptero/axolotis-core-plugins v1.0.0
 *   https://github.com/ApteroSAS/axolotis-player
 *
 *   Copyright (c) Aptero (https://github.com/ApteroSAS/axolotis-player) and project contributors.
 *
 *   This source code is licensed under the MIT license found in the
 *   LICENSE file in the root directory of this source tree.
 *
 */
!function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define("axolotis-core-plugins",[],o):"object"==typeof exports?exports["axolotis-core-plugins"]=o():e["axolotis-core-plugins"]=o()}(self,(function(){return function(){var e,o,t,n,r={919:function(e){
/*!
 *
 *   @aptero/axolotis-player v1.0.0
 *   https://github.com/ApteroSAS/axolotis-player
 *
 *   Copyright (c) Aptero (https://github.com/ApteroSAS/axolotis-player) and project contributors.
 *
 *   This source code is licensed under the MIT license found in the
 *   LICENSE file in the root directory of this source tree.
 *
 */
self,e.exports=function(){"use strict";var e={630:function(e,o,t){function n(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}t.r(o),t.d(o,{Factory:function(){return r},FrameLoop:function(){return i}});class r{async createService(e){let o=await e.getService("@aptero/axolotis-player/modules/core/loader/CodeLoaderService"),t=new i;return o.awaitInitialLoading().then((()=>{t.startAnimationFrameLoop()})),t}}class i{constructor(){n(this,"loops",{}),n(this,"prevTime",0),n(this,"monitoringStart",(()=>{})),n(this,"monitoringEnd",(()=>{}))}startAnimationFrameLoop(){const e=o=>{this.monitoringStart(i.name);const t=o-this.prevTime;this.prevTime=o,requestAnimationFrame(e);for(const e in this.loops)this.monitoringStart(e),this.loops[e](t),this.monitoringEnd(e);this.monitoringEnd(i.name)};requestAnimationFrame(e)}setMonitoringCallback(e,o){this.monitoringStart=e,this.monitoringEnd=o}removeLoop(e){delete this.loops[e],this.monitoringStart(e),this.monitoringEnd(e)}addLoop(e,o){if(this.loops[e])throw new Error;this.loops[e]=o}getType(){return i.name}}},905:function(e,o,t){t.r(o),t.d(o,{Factory:function(){return i},WorldService:function(){return c},registerNewWorld:function(){return l}});var n=t(454),r=t(241);class i{constructor(){}async createService(e){return new c(e)}}let a=[],s=[];function l(e){(0,r.G)("worlds").worlds.push(e),(0,r.G)("worlds").activeWorld<0&&((0,r.G)("worlds").activeWorld=0,(0,r.G)("worlds").world=(0,r.G)("worlds").worlds[(0,r.G)("worlds").activeWorld])}(0,r.G)("worlds").activeWorld||((0,r.G)("worlds").worlds=[],(0,r.G)("worlds").activeWorld=-1);class c{constructor(e){var o,t,i;i=void 0,(t="world")in(o=this)?Object.defineProperty(o,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[t]=i,console.log("info");let a=null;for(const o of this.getWorlds())o.getFirstComponentByType(n.e.name)==e&&(a=o);if(!a)throw new Error;this.world=a,e.getService("@aptero/axolotis-player/modules/core/loader/CodeLoaderService").then((async e=>{e.awaitInitialLoading();for(const e of s)e()})),(0,r.G)("worlds").activeWorld>=0&&this.setActiveWorldByNumber((0,r.G)("worlds").activeWorld)}getType(){return c.name}getWorlds(){return(0,r.G)("worlds").worlds}getActiveWorld(){return this.getWorlds()[(0,r.G)("worlds").activeWorld]}isActiveWorld(){return this.world==this.getActiveWorld()}addOnWorldChangeCallback(e){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.push(e),o&&e()}addOnWorldAdded(e){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];s.push(e),o&&e()}setActiveWorld(e){for(let o=0;o<this.getWorlds().length;o++)if(e==this.getWorlds()[o])return void this.setActiveWorldByNumber(o);throw new Error}setActiveWorldByNumber(e){if((0,r.G)("worlds").activeWorld!=e){(0,r.G)("worlds").activeWorld=e,(0,r.G)("worlds").world=this.getWorlds()[e];for(const e of a)e()}}}},82:function(e,o,t){t.d(o,{Vf:function(){return a},Ag:function(){return r},dK:function(){return i}});var n=t(241);function r(e,o){if((0,n.G)("localModules")[e])throw new Error("Module already defined");(0,n.G)("localModules")[e]=o}function i(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&console.log("imported module :",e),Object.assign((0,n.G)("localModules"),e)}async function a(e){let o=null;if(!(0,n.G)("localModules")[e])throw console.log("local module installed:",(0,n.G)("localModules")),new Error("unknown module - please register it - "+e);return o=await async function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const t=await o[e](),n=t.module;for(const e in n){const o=n[e];if(o.prototype&&o.prototype.constructor.name===t.classname)return new o}throw new Error("invalid factory "+e+" - "+t.classname)}(e,(0,n.G)("localModules")),o}i({"@aptero/axolotis-player/modules/core/WorldService":async()=>{const e=await Promise.resolve().then(t.bind(t,905));return{module:e,classname:e.Factory.name}},"@aptero/axolotis-player/modules/FrameLoop":async()=>{const e=await Promise.resolve().then(t.bind(t,630));return{module:e,classname:e.Factory.name}}})},241:function(e,o,t){t.d(o,{G:function(){return r}}),window&&(window.axolotis||(window.axolotis={}));var n=window.axolotis;function r(e){return n[e]||(n[e]={}),n[e]}},240:function(e,o,t){t.d(o,{i:function(){return r}});var n=t(82);class r{constructor(){var e,o,t;t={},(o="service")in(e=this)?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t}setService(e,o){this.service[e]=Promise.resolve(o)}async getService(e){if(this.service[e]){const o=await this.service[e];if(!o)throw new Error("error");return o}if(!this.service[e]){let o=(0,n.Vf)(e);this.service[e]=new Promise((async e=>{e(await(await o).createService(this))}))}return await this.service[e]}}},454:function(e,o,t){t.d(o,{e:function(){return r}});var n=t(240);class r extends n.i{getType(){return r.name}}},147:function(e){e.exports={i8:"1.0.0"}}},o={};function t(n){var r=o[n];if(void 0!==r)return r.exports;var i=o[n]={exports:{}};return e[n](i,i.exports,t),i.exports}t.d=function(e,o){for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return function(){t.r(n),t.d(n,{CodeLoaderComponent:function(){return i},FrameLoop:function(){return h.FrameLoop},LazyServices:function(){return g.i},ServiceEntity:function(){return e.e},WorldEntity:function(){return c},WorldService:function(){return l.WorldService},initHtml:function(){return m},initHtmlFromUrl:function(){return p},registerLocalModule:function(){return o.Ag},registerLocalModuleList:function(){return o.dK}});var e=t(454),o=t(82);function r(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}class i{constructor(){r(this,"initialLoading",void 0),r(this,"initialLoadingResolver",void 0),this.initialLoading=new Promise((e=>{this.initialLoadingResolver=e}))}getType(){return i.name}async awaitInitialLoading(){await this.initialLoading}async startLoadingJson(t,n,r){let i=[];for(const e of n.entities)for(const n of e.components){let e=n.config;i.push((()=>new Promise((async(r,i)=>{const a=await(0,o.Vf)(n.module);let s=await a.createComponent(t,e||{});if(!s.getType)throw new Error("Not a component : "+n.module+" "+s.constructor.name);t.addComponent(s),r(a)}))))}for(const o of n.services)i.push((()=>new Promise((async(n,r)=>{let i=await t.getFirstComponentByType(e.e.name);await i.getService(o.module),n(i)}))));let a=function(e,o){let t=[],n=0;for(const r of e){const i=r();t.push(i),i.then((()=>{n++,o(n,e.length)}))}return Promise.all(t)}(i,r);return a.then((e=>{void 0!==this.initialLoadingResolver&&this.initialLoadingResolver(e)})),a.catch((e=>{console.error(e)})),a}}function a(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}var s=class{constructor(e){this.name=e,a(this,"components",[]),a(this,"waitingForComponent",{})}addComponent(e){if(this.components.push(e),this.waitingForComponent[e.getType()]){for(const o of this.waitingForComponent[e.getType()])o(e);delete this.waitingForComponent[e.getType()]}return e}removeAllComponents(){this.components.forEach((e=>{this.removeComponent(e)}))}removeComponent(e){return"destroy"in e&&e.destroy(),this.components=this.components.filter((o=>o!=e)),e}addComponents(e){e.forEach((e=>{this.addComponent(e)}))}getComponents(){return this.components}getComponentByType(e){let o=[];return this.components.forEach((t=>{t.getType()===e&&o.push(t)})),o}getComponentByTypeStartsWith(e){let o=[];return this.components.forEach((t=>{t.getType().startsWith(e)&&o.push(t)})),o}getFirstComponentByTypeStartsWith(e){return this.getComponentByTypeStartsWith(e)[0]}getFirstComponentByType(e){return this.getComponentByType(e)[0]}async getFirstComponentByTypeAsync(e){return this.getComponentByType(e)[0]?this.getComponentByType(e)[0]:(this.waitingForComponent[e]||(this.waitingForComponent[e]=[]),new Promise(((o,t)=>{this.waitingForComponent[e].push(o)})))}getType(){return this.name}},l=t(905);class c extends s{constructor(){super("world"),(0,l.registerNewWorld)(this)}}const u=t(147).i8;console.log(u);const d=e=>{"complete"===document.readyState&&document.body?e():window.addEventListener("DOMContentLoaded",e)};async function p(o){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.onProgress||(t.onProgress=(e,t)=>{console.log("["+o+"] : ["+e+"/"+t+"]")}),t.onLoaded||(t.onLoaded=()=>{console.log("["+o+"] : loading complete")});let n=new e.e,r=new c;r.addComponent(n);let a=new i;n.setService("@aptero/axolotis-player/modules/core/loader/CodeLoaderService",a);const s=await fetch(o),l=await s.text();let u=(new DOMParser).parseFromString(l,"text/html").body.getElementsByTagName("ax-scene");return!u||u&&0==u.length?(console.warn("Axolotis scene not found (no tag ax-scene)"),void t.onLoaded()):(console.log(u),await a.startLoadingJson(r,f(u),t.onProgress),t.onLoaded(),r)}function m(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o.onProgress||(o.onProgress=(e,o)=>{console.log("["+e+"/"+o+"]")}),o.onLoaded||(o.onLoaded=()=>{console.log("loading complete")});let t=new e.e,n=new c;n.addComponent(t);let r=new i;return t.setService("@aptero/axolotis-player/modules/core/loader/CodeLoaderService",r),d((()=>{let e=window.document.body.getElementsByTagName("ax-scene");if(!e||e&&0==e.length)return console.warn("Axolotis scene not found (no tag ax-scene)"),void o.onLoaded();console.log(e),r.startLoadingJson(n,f(e),o.onProgress).then(o.onLoaded)})),n}function f(e){let o=e[0];const t={version:"2.0",entities:[],services:[]};for(const e of o.getElementsByTagName("ax-entity")){let o={components:[]};for(const t of e.getElementsByTagName("ax-component")){let e=t.getAttribute("config").replace(/(['"])?([a-z0-9A-Z_]+)(['"])?:/g,'"$2": '),n={module:t.getAttribute("module"),config:JSON.parse(e)};o.components.push(n)}t.entities.push(o)}for(const e of o.getElementsByTagName("ax-service"))t.services.push({module:e.getAttribute("module")});return t}var g=t(240),h=t(630)}(),n}()}},i={};function a(e){var o=i[e];if(void 0!==o)return o.exports;var t=i[e]={exports:{}};return r[e](t,t.exports,a),t.exports}a.m=r,e=[],a.O=function(o,t,n,r){if(!t){var i=1/0;for(u=0;u<e.length;u++){t=e[u][0],n=e[u][1],r=e[u][2];for(var s=!0,l=0;l<t.length;l++)(!1&r||i>=r)&&Object.keys(a.O).every((function(e){return a.O[e](t[l])}))?t.splice(l--,1):(s=!1,r<i&&(i=r));if(s){e.splice(u--,1);var c=n();void 0!==c&&(o=c)}}return o}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[t,n,r]},a.F={},a.E=function(e){Object.keys(a.F).map((function(o){a.F[o](e)}))},a.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(o,{a:o}),o},a.d=function(e,o){for(var t in o)a.o(o,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:o[t]})},a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(o,t){return a.f[t](e,o),o}),[]))},a.u=function(e){return{133:"@aptero/axolotis-core-plugins/modules/debug/PerformanceStats",324:"@aptero/axolotis-core-plugins/modules/portals/PortalsService",404:"@aptero/axolotis-core-plugins/three/examples/jsm/loaders/GLTFLoader",408:"@aptero/axolotis-core-plugins/modules/controller/pathFindingPlayer/Input",422:"@aptero/axolotis-core-plugins/modules/three/ThreeLib",487:"@aptero/axolotis-core-plugins/modules/controller/cameraController/OrbitController",614:"@aptero/axolotis-core-plugins/modules/Sky",625:"@aptero/axolotis-core-plugins/modules/controller/pathFindingPlayer/NavMeshPlayer",796:"@aptero/axolotis-core-plugins/three",826:"@aptero/axolotis-core-plugins/modules/spoke/SpokeRoomLoader",877:"@aptero/axolotis-core-plugins/modules/controller/PlayerService",966:"@aptero/axolotis-core-plugins/modules/debug/DebugBtn",968:"@aptero/axolotis-core-plugins/modules/portals/PortalLink"}[e]+"."+{133:"dc54e55ae054b1426850",324:"5628a086da912b487113",404:"63a688de310f69a848e0",408:"4b90e97bc3ffa3201f2b",422:"018e8ce418e6b8acde22",487:"cc7989f543d3fa255b55",614:"98572f7cf40a121ea161",625:"a3a3cacfc79cdd2e85cc",796:"9f0fdafb9c6b1f5bbad1",826:"1976ca09cdfa5b5efce1",877:"5bb890de913b07288bf7",966:"9cb9bceab0b6cd657738",968:"7f725238ea57c675ddfe"}[e]+".js"},a.miniCssF=function(e){},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},o={},t="axolotis-core-plugins:",a.l=function(e,n,r,i){if(o[e])o[e].push(n);else{var s,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==t+r){s=d;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,a.nc&&s.setAttribute("nonce",a.nc),s.setAttribute("data-webpack",t+r),s.src=e),o[e]=[n];var p=function(t,n){s.onerror=s.onload=null,clearTimeout(m);var r=o[e];if(delete o[e],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach((function(e){return e(n)})),t)return t(n)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),l&&document.head.appendChild(s)}},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e;a.g.importScripts&&(e=a.g.location+"");var o=a.g.document;if(!e&&o&&(o.currentScript&&(e=o.currentScript.src),!e)){var t=o.getElementsByTagName("script");t.length&&(e=t[t.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e}(),function(){var e={249:0};a.f.j=function(o,t){var n=a.o(e,o)?e[o]:void 0;if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=e[o]=[t,r]}));t.push(n[2]=r);var i=a.p+a.u(o),s=new Error;a.l(i,(function(t){if(a.o(e,o)&&(0!==(n=e[o])&&(e[o]=void 0),n)){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;s.message="Loading chunk "+o+" failed.\n("+r+": "+i+")",s.name="ChunkLoadError",s.type=r,s.request=i,n[1](s)}}),"chunk-"+o,o)}},a.F.j=function(o){if(!a.o(e,o)||void 0===e[o]){e[o]=null;var t=document.createElement("link");a.nc&&t.setAttribute("nonce",a.nc),t.rel="prefetch",t.as="script",t.href=a.p+a.u(o),document.head.appendChild(t)}},a.O.j=function(o){return 0===e[o]};var o=function(o,t){var n,r,i=t[0],s=t[1],l=t[2],c=0;if(i.some((function(o){return 0!==e[o]}))){for(n in s)a.o(s,n)&&(a.m[n]=s[n]);if(l)var u=l(a)}for(o&&o(t);c<i.length;c++)r=i[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(u)},t=self.webpackChunkaxolotis_core_plugins=self.webpackChunkaxolotis_core_plugins||[];t.forEach(o.bind(null,0)),t.push=o.bind(null,t.push.bind(t))}(),n={133:[796,404],422:[796,404]},a.f.prefetch=function(e,o){Promise.all(o).then((function(){var o=n[e];Array.isArray(o)&&o.map(a.E)}))},a.O(0,[249],(function(){[796,487,408,625,877,966,133,422,324,968,614,826].map(a.E)}),5);var s={};return function(){"use strict";a.r(s),a.d(s,{load:function(){return o}});var e=a(919);function o(){const o={"@aptero/axolotis-core-plugins/modules/controller/cameraController/OrbitController":async()=>{const e=await Promise.all([a.e(796),a.e(487)]).then(a.bind(a,681));return{module:e,classname:e.Factory.name}},"@aptero/axolotis-core-plugins/modules/controller/pathFindingPlayer/Input":async()=>{const e=await a.e(408).then(a.bind(a,823));return{module:e,classname:e.Factory.name}},"@aptero/axolotis-core-plugins/modules/controller/pathFindingPlayer/NavMeshPlayer":async()=>{const e=await Promise.all([a.e(796),a.e(625)]).then(a.bind(a,7));return{module:e,classname:e.Factory.name}},"@aptero/axolotis-core-plugins/modules/controller/PlayerService":async()=>{const e=await a.e(877).then(a.bind(a,912));return{module:e,classname:e.Factory.name}},"@aptero/axolotis-core-plugins/modules/debug/DebugBtn":async()=>{const e=await a.e(966).then(a.bind(a,551));return{module:e,classname:e.Factory.name}},"@aptero/axolotis-core-plugins/modules/debug/PerformanceStats":async()=>{const e=await Promise.all([a.e(796),a.e(625),a.e(133)]).then(a.bind(a,997));return{module:e,classname:e.Factory.name}},"@aptero/axolotis-core-plugins/modules/three/ThreeLib":async()=>{const e=await a.e(422).then(a.bind(a,950));return{module:e,classname:e.Factory.name}},"@aptero/axolotis-core-plugins/modules/portals/PortalsService":async()=>{const e=await a.e(324).then(a.bind(a,237));return{module:e,classname:e.Factory.name}},"@aptero/axolotis-core-plugins/modules/portals/PortalLink":async()=>{const e=await Promise.all([a.e(796),a.e(968)]).then(a.bind(a,481));return{module:e,classname:e.Factory.name}},"@aptero/axolotis-core-plugins/modules/Sky":async()=>{const e=await Promise.all([a.e(796),a.e(614)]).then(a.bind(a,259));return{module:e,classname:e.Factory.name}},"@aptero/axolotis-core-plugins/modules/spoke/SpokeRoomLoader":async()=>{const e=await a.e(826).then(a.bind(a,342));return{module:e,classname:e.Factory.name}}};(0,e.registerLocalModuleList)(o)}o()}(),s=a.O(s)}()}));
//# sourceMappingURL=index.js.map